<template>
  <section id="section5">
    <div class="txt4 visible">
      <h3>Improved ROI on your inside sales</h3>
      <p>
        Serio Verify is visualized real time in an executive dashboard. Monitor
        your entire value chain and cost structure to help you make the right
        decisions.
      </p>
    </div>

    <svg
      version="1.1"
      xmlns="http://www.w3.org/2000/svg"
      xmlns:xlink="http://www.w3.org/1999/xlink"
      viewBox="0 0 1440 900"
    >
      <!--BASE GFX-->
      <g fill="#111">
        <path
          d="M703,509.7c-4,3.2-9.4,4.4-15.4,4.4h-5.9v17.2h-18.1v-55.2h24c6,0,11.4,1.2,15.4,4.4s6.2,8,6.2,14.6
					C709.2,501.7,707,506.5,703,509.7z M689,490.7c-1.2-0.9-2.4-1-4.4-1h-3v10.8h3c2,0,3.2-0.2,4.4-1c1.3-0.9,2-2.2,2-4.4
					C691,492.9,690.2,491.5,689,490.7z"
        ></path>
        <path
          d="M765.6,531.3h-20.8l-8.8-18.4h-2.3v18.4h-18.1v-55.2h24c6.8,0,12,1.2,16,4s6.8,7.6,6.8,13.6c0,11.2-6.8,15.2-9.2,16.6
					L765.6,531.3z M742.2,490.7c-0.8-0.6-2-1-4-1h-4.6v9.6h4.6c2,0,3.3-0.4,4-1c0.9-0.6,2-1.4,2-3.8S743,491.3,742.2,490.7z"
        ></path>
        <path
          d="M798,532.2c-17.2,0-30-10.5-30-28.5c0-18,12.8-28.6,30-28.6s30,10.6,30,28.6C828,521.8,815.2,532.2,798,532.2z M798,490.5
					c-7.2,0-11.8,5.3-11.8,12.9c0,7.6,4.6,12.9,11.8,12.9s11.8-5.3,11.8-12.9C809.8,495.8,805.2,490.5,798,490.5z"
        ></path>
        <path
          d="M874,490.3h-20.4v8.6h19.2v14.2h-19.2v18.2h-18v-55.2H874V490.3z"
        ></path>
        <path d="M899.7,531.3h-18.1v-55.2h18.1V531.3z"></path>
        <path
          d="M949.8,490.2h-13v41.1h-18.1v-41.1h-13v-14.1h44.1V490.2z"
        ></path>
        <path
          d="M1002.2,531.3h-19.6l-2.2-7.8h-15.8l-2.1,7.8h-18.8l19.2-55.2h20L1002.2,531.3z M976.7,509.7l-4.1-14.8l-4.1,14.8H976.7z"
        ></path>
        <path
          d="M1049,527.7c-3.6,2.4-9.2,3.6-14.4,3.6h-27.2v-55.2h22.8c4.8,0,10,0.4,14,2s8.2,5.6,8.2,12c0,6.4-4.2,10.8-7.8,12.2
					c6.4,1.8,10.6,6.6,10.6,13C1055.2,521.7,1052.6,525.3,1049,527.7z M1033,489.9c-1.2-0.8-2-0.8-4-0.8h-3.6v8h3.6c2,0,2.8-0.1,4-0.9
					c1.2-0.8,1.6-1.8,1.6-3.1C1034.6,491.7,1034.2,490.7,1033,489.9z M1035.4,510.1c-1.2-0.8-2-1-4-1h-6v8.8h6c2,0,2.8-0.2,4-1
					c1.2-0.8,1.6-2,1.6-3.4C1037,512.1,1036.6,510.9,1035.4,510.1z"
        ></path>
        <path d="M1080.3,531.3h-18.1v-55.2h18.1V531.3z"></path>
        <path d="M1127.1,531.3h-36.8v-55.2h18v40.4h18.8V531.3z"></path>
        <path d="M1152,531.3h-18.1v-55.2h18.1V531.3z"></path>
        <path d="M1202,490.2h-13v41.1h-18.1v-41.1h-13v-14.1h44.1V490.2z"></path>
        <path
          d="M1258.8,476.1l-19.2,33.6v21.6h-18.1v-21.6l-19.1-33.6h20l8.2,18.6l8.2-18.6H1258.8z"
        ></path>
      </g>

      <path
        fill="none"
        stroke="#111"
        stroke-width="10"
        d="M809,0 809,231 488,231 488,510 642,510"
      ></path>
      <line
        fill="none"
        stroke="#111"
        stroke-width="10"
        x1="1281"
        y1="511"
        x2="1437"
        y2="511"
      ></line>

      <!--<rect x="482.6" y="0.6" fill="#92259E" width="368" height="546"/>-->
      <!--<rect x="482.3" y="364.1" fill="#269B31" width="958" height="182"/>-->

      <!--MASKED GFX-->
      <g style="clip-path: url(#profitClipTop);">
        <path
          id="svg_8a"
          fill="none"
          stroke="#ffdf86"
          stroke-width="10"
          d="M809,0 809,231 488,231 488,510 642,510"
        ></path>
        <line
          id="svg_8b"
          fill="none"
          stroke="#ffdf86"
          stroke-width="10"
          x1="1281"
          y1="511"
          x2="1437"
          y2="511"
        ></line>
        <!-- </g> -->
        <!-- <g style="clip-path: url(#profitClipRight);"> -->
        <!-- <polyline
          fill="none"
          stroke="#3AAFA9"
          stroke-width="10"
          stroke-miterlimit="10"
          points="809,0 809,231 488,231 488,510 642,510"
        ></polyline> -->
        <g fill="none" stroke-width="5" stroke="#ffdf86">
          <path
            id="svg_9a"
            d="M703,509.7c-4,3.2-9.4,4.4-15.4,4.4h-5.9v17.2h-18.1v-55.2h24c6,0,11.4,1.2,15.4,4.4s6.2,8,6.2,14.6
						C709.2,501.7,707,506.5,703,509.7z M689,490.7c-1.2-0.9-2.4-1-4.4-1h-3v10.8h3c2,0,3.2-0.2,4.4-1c1.3-0.9,2-2.2,2-4.4
						C691,492.9,690.2,491.5,689,490.7z"
          ></path>
          <path
            id="svg_9b"
            d="M765.6,531.3h-20.8l-8.8-18.4h-2.3v18.4h-18.1v-55.2h24c6.8,0,12,1.2,16,4s6.8,7.6,6.8,13.6c0,11.2-6.8,15.2-9.2,16.6
						L765.6,531.3z M742.2,490.7c-0.8-0.6-2-1-4-1h-4.6v9.6h4.6c2,0,3.3-0.4,4-1c0.9-0.6,2-1.4,2-3.8S743,491.3,742.2,490.7z"
          ></path>
          <path
            id="svg_9c"
            d="M798,532.2c-17.2,0-30-10.5-30-28.5c0-18,12.8-28.6,30-28.6s30,10.6,30,28.6C828,521.8,815.2,532.2,798,532.2z M798,490.5
						c-7.2,0-11.8,5.3-11.8,12.9c0,7.6,4.6,12.9,11.8,12.9s11.8-5.3,11.8-12.9C809.8,495.8,805.2,490.5,798,490.5z"
          ></path>
          <path
            id="svg_9d"
            d="M874,490.3h-20.4v8.6h19.2v14.2h-19.2v18.2h-18v-55.2H874V490.3z"
          ></path>
          <path id="svg_9e" d="M899.7,531.3h-18.1v-55.2h18.1V531.3z"></path>
          <path
            id="svg_9f"
            d="M949.8,490.2h-13v41.1h-18.1v-41.1h-13v-14.1h44.1V490.2z"
          ></path>
          <path
            id="svg_9g"
            d="M1002.2,531.3h-19.6l-2.2-7.8h-15.8l-2.1,7.8h-18.8l19.2-55.2h20L1002.2,531.3z M976.7,509.7l-4.1-14.8l-4.1,14.8H976.7z"
          ></path>
          <path
            id="svg_9h"
            d="M1049,527.7c-3.6,2.4-9.2,3.6-14.4,3.6h-27.2v-55.2h22.8c4.8,0,10,0.4,14,2s8.2,5.6,8.2,12c0,6.4-4.2,10.8-7.8,12.2
						c6.4,1.8,10.6,6.6,10.6,13C1055.2,521.7,1052.6,525.3,1049,527.7z M1033,489.9c-1.2-0.8-2-0.8-4-0.8h-3.6v8h3.6c2,0,2.8-0.1,4-0.9
						c1.2-0.8,1.6-1.8,1.6-3.1C1034.6,491.7,1034.2,490.7,1033,489.9z M1035.4,510.1c-1.2-0.8-2-1-4-1h-6v8.8h6c2,0,2.8-0.2,4-1
						c1.2-0.8,1.6-2,1.6-3.4C1037,512.1,1036.6,510.9,1035.4,510.1z"
          ></path>
          <path id="svg_9i" d="M1080.3,531.3h-18.1v-55.2h18.1V531.3z"></path>
          <path
            id="svg_9j"
            d="M1127.1,531.3h-36.8v-55.2h18v40.4h18.8V531.3z"
          ></path>
          <path id="svg_9k" d="M1152,531.3h-18.1v-55.2h18.1V531.3z"></path>
          <path
            id="svg_9l"
            d="M1202,490.2h-13v41.1h-18.1v-41.1h-13v-14.1h44.1V490.2z"
          ></path>
          <path
            id="svg_9m"
            d="M1258.8,476.1l-19.2,33.6v21.6h-18.1v-21.6l-19.1-33.6h20l8.2,18.6l8.2-18.6H1258.8z"
          ></path>
        </g>
        <!-- <path
            fill="none"
            stroke="#ffdf86"
            stroke-width="10"
            stroke-miterlimit="10"
            d="M809,-2 809,231 488,231 488,510 642,510"
          ></path>
          <line
            fill="none"
            stroke="#ffdf86"
            stroke-width="10"
            stroke-miterlimit="10"
            x1="1281"
            y1="511"
            x2="1437"
            y2="511"
          ></line> -->
      </g>
    </svg>
  </section>
</template>

<script>
import { mapGetters, mapActions } from "vuex";

export default {
  name: "Profitability",
  data() {
    return {
      svg8a: 0,
      svg8b: 0,
      svg9a: 0,
      svg9b: 0,
      svg9c: 0,
      svg9d: 0,
      svg9e: 0,
      svg9f: 0,
      svg9g: 0,
      svg9h: 0,
      svg9i: 0,
      svg9j: 0,
      svg9k: 0,
      svg9l: 0,
      svg9m: 0
    };
  },
  computed: mapGetters(["docHeightPerc", "sectionsEndingPerc"]),
  methods: {
    ...mapActions([
      "getDocumentHeightPercentage",
      "getSectionsClientHeight",
      "fillStroke",
      "unfillStroke",
      "setDashArrayAndOffset"
    ]),

    //event on scroll
    handleScroll() {
      this.getDocumentHeightPercentage();
      let start = this.sectionsEndingPerc.section3 + 1.4;
      // window.console.log(start);

      if (this.docHeightPerc < start) {
        this.unfillStroke([
          this.svg8a,
          this.svg8b,
          this.svg9a,
          this.svg9b,
          this.svg9c,
          this.svg9d,
          this.svg9e,
          this.svg9f,
          this.svg9g,
          this.svg9h,
          this.svg9i,
          this.svg9j,
          this.svg9k,
          this.svg9l,
          this.svg9m
        ]);
      } else if (
        this.docHeightPerc >= start &&
        this.docHeightPerc < start + 1
      ) {
        this.drawPath(this.svg8a, start, start + 1);
        this.unfillStroke([
          this.svg8b,
          this.svg9a,
          this.svg9b,
          this.svg9c,
          this.svg9d,
          this.svg9e,
          this.svg9f,
          this.svg9g,
          this.svg9h,
          this.svg9i,
          this.svg9j,
          this.svg9k,
          this.svg9l,
          this.svg9m
        ]);
      } else if (
        this.docHeightPerc >= start + 1 &&
        this.docHeightPerc < start + 2.3
      ) {
        document.querySelector(".txt2").style.opacity = "1";
        if (
          this.docHeightPerc >= start + 1 &&
          this.docHeightPerc < start + 1.1
        ) {
          this.drawPath(this.svg9a, start + 1, start + 1.1);
          this.fillStroke([this.svg8a]);
          this.unfillStroke([
            this.svg8b,
            this.svg9b,
            this.svg9c,
            this.svg9d,
            this.svg9e,
            this.svg9f,
            this.svg9g,
            this.svg9h,
            this.svg9i,
            this.svg9j,
            this.svg9k,
            this.svg9l,
            this.svg9m
          ]);
        } else if (
          this.docHeightPerc >= start + 1.1 &&
          this.docHeightPerc < start + 1.2
        ) {
          this.drawPath(this.svg9b, start + 1.1, start + 1.2);
          // document.querySelector(".txt4").style.opacity = "0";
          this.fillStroke([this.svg8a, this.svg9a]);
          this.unfillStroke([
            this.svg8b,
            this.svg9c,
            this.svg9d,
            this.svg9e,
            this.svg9f,
            this.svg9g,
            this.svg9h,
            this.svg9i,
            this.svg9j,
            this.svg9k,
            this.svg9l,
            this.svg9m
          ]);
        } else if (
          this.docHeightPerc >= start + 1.2 &&
          this.docHeightPerc < start + 1.3
        ) {
          this.drawPath(this.svg9c, start + 1.2, start + 1.3);
          // document.querySelector(".txt4").style.opacity = "1";
          this.fillStroke([this.svg8a, this.svg9a, this.svg9b]);
          this.unfillStroke([
            this.svg8b,
            this.svg9d,
            this.svg9e,
            this.svg9f,
            this.svg9g,
            this.svg9h,
            this.svg9i,
            this.svg9j,
            this.svg9k,
            this.svg9l,
            this.svg9m
          ]);
        } else if (
          this.docHeightPerc >= start + 1.3 &&
          this.docHeightPerc <= start + 1.4
        ) {
          this.drawPath(this.svg9d, start + 1.3, start + 1.4);
          this.fillStroke([this.svg8a, this.svg9a, this.svg9b, this.svg9c]);
          this.unfillStroke([
            this.svg8b,
            this.svg9e,
            this.svg9f,
            this.svg9g,
            this.svg9h,
            this.svg9i,
            this.svg9j,
            this.svg9k,
            this.svg9l,
            this.svg9m
          ]);
        } else if (
          this.docHeightPerc >= start + 1.4 &&
          this.docHeightPerc <= start + 1.5
        ) {
          this.drawPath(this.svg9e, start + 1.4, start + 1.5);
          this.fillStroke([
            this.svg8a,
            this.svg9a,
            this.svg9b,
            this.svg9c,
            this.svg9d
          ]);
          this.unfillStroke([
            this.svg8b,
            this.svg9f,
            this.svg9g,
            this.svg9h,
            this.svg9i,
            this.svg9j,
            this.svg9k,
            this.svg9l,
            this.svg9m
          ]);
        } else if (
          this.docHeightPerc >= start + 1.5 &&
          this.docHeightPerc <= start + 1.6
        ) {
          this.drawPath(this.svg9f, start + 1.5, start + 1.6);
          this.fillStroke([
            this.svg8a,
            this.svg9a,
            this.svg9b,
            this.svg9c,
            this.svg9d,
            this.svg9e
          ]);
          this.unfillStroke([
            this.svg8b,
            this.svg9g,
            this.svg9h,
            this.svg9i,
            this.svg9j,
            this.svg9k,
            this.svg9l,
            this.svg9m
          ]);
        } else if (
          this.docHeightPerc >= start + 1.6 &&
          this.docHeightPerc <= start + 1.7
        ) {
          this.drawPath(this.svg9g, start + 1.6, start + 1.7);
          this.fillStroke([
            this.svg8a,
            this.svg9a,
            this.svg9b,
            this.svg9c,
            this.svg9d,
            this.svg9e,
            this.svg9f
          ]);
          this.unfillStroke([
            this.svg8b,
            this.svg9h,
            this.svg9i,
            this.svg9j,
            this.svg9k,
            this.svg9l,
            this.svg9m
          ]);
        } else if (
          this.docHeightPerc >= start + 1.7 &&
          this.docHeightPerc <= start + 1.8
        ) {
          this.drawPath(this.svg9h, start + 1.7, start + 1.8);
          this.fillStroke([
            this.svg8a,
            this.svg9a,
            this.svg9b,
            this.svg9c,
            this.svg9d,
            this.svg9e,
            this.svg9f,
            this.svg9g
          ]);
          this.unfillStroke([
            this.svg8b,
            this.svg9i,
            this.svg9j,
            this.svg9k,
            this.svg9l,
            this.svg9m
          ]);
        } else if (
          this.docHeightPerc >= start + 1.8 &&
          this.docHeightPerc <= start + 1.9
        ) {
          this.drawPath(this.svg9i, start + 1.8, start + 1.9);
          this.fillStroke([
            this.svg8a,
            this.svg9a,
            this.svg9b,
            this.svg9c,
            this.svg9d,
            this.svg9e,
            this.svg9f,
            this.svg9g,
            this.svg9h
          ]);
          this.unfillStroke([
            this.svg8b,
            this.svg9j,
            this.svg9k,
            this.svg9l,
            this.svg9m
          ]);
        } else if (
          this.docHeightPerc >= start + 1.9 &&
          this.docHeightPerc <= start + 2
        ) {
          this.drawPath(this.svg9j, start + 1.9, start + 2);
          this.fillStroke([
            this.svg8a,
            this.svg9a,
            this.svg9b,
            this.svg9c,
            this.svg9d,
            this.svg9e,
            this.svg9f,
            this.svg9g,
            this.svg9h,
            this.svg9i
          ]);
          this.unfillStroke([this.svg8b, this.svg9k, this.svg9l, this.svg9m]);
        } else if (
          this.docHeightPerc >= start + 2 &&
          this.docHeightPerc <= start + 2.1
        ) {
          this.drawPath(this.svg9k, start + 2, start + 2.1);
          this.fillStroke([
            this.svg8a,
            this.svg9a,
            this.svg9b,
            this.svg9c,
            this.svg9d,
            this.svg9e,
            this.svg9f,
            this.svg9g,
            this.svg9h,
            this.svg9i,
            this.svg9j
          ]);
          this.unfillStroke([this.svg8b, this.svg9l, this.svg9m]);
        } else if (
          this.docHeightPerc >= start + 2.1 &&
          this.docHeightPerc <= start + 2.2
        ) {
          this.drawPath(this.svg9l, start + 2.1, start + 2.2);
          this.fillStroke([
            this.svg8a,
            this.svg9a,
            this.svg9b,
            this.svg9c,
            this.svg9d,
            this.svg9e,
            this.svg9f,
            this.svg9g,
            this.svg9h,
            this.svg9i,
            this.svg9j,
            this.svg9k
          ]);
          this.unfillStroke([this.svg8b, this.svg9m]);
        } else if (
          this.docHeightPerc >= start + 2.2 &&
          this.docHeightPerc <= start + 2.3
        ) {
          this.drawPath(this.svg9m, start + 2.2, start + 2.3);
          this.fillStroke([
            this.svg8a,
            this.svg9a,
            this.svg9b,
            this.svg9c,
            this.svg9d,
            this.svg9e,
            this.svg9f,
            this.svg9g,
            this.svg9h,
            this.svg9i,
            this.svg9j,
            this.svg9k,
            this.svg9l
          ]);
          this.unfillStroke([this.svg8b]);
        }
      } else if (
        this.docHeightPerc >= start + 2.3 &&
        this.docHeightPerc < start + 3
      ) {
        this.drawPath(this.svg8b, start + 2.3, start + 3);
        this.fillStroke([
          this.svg8a,
          this.svg9a,
          this.svg9b,
          this.svg9c,
          this.svg9d,
          this.svg9e,
          this.svg9f,
          this.svg9g,
          this.svg9h,
          this.svg9i,
          this.svg9j,
          this.svg9k,
          this.svg9l,
          this.svg9m
        ]);
      } else if (this.docHeightPerc >= start + 2.8) {
        this.fillStroke([
          this.svg8a,
          this.svg8b,
          this.svg9a,
          this.svg9b,
          this.svg9c,
          this.svg9d,
          this.svg9e,
          this.svg9f,
          this.svg9g,
          this.svg9h,
          this.svg9i,
          this.svg9j,
          this.svg9k,
          this.svg9l,
          this.svg9m
        ]);
      }

      if (this.docHeightPerc >= start + 1.6) {
        document.querySelector(".txt4").style.opacity = "1";
      }
    },

    //draw line
    drawPath(el, startPerc = 0, endPerc, sign = 1) {
      var drawLen = 0;
      var pathLen = el.getTotalLength();
      var scrollPerc = (this.docHeightPerc - startPerc) / (endPerc - startPerc);
      drawLen = pathLen - pathLen * scrollPerc;
      el.setAttribute("stroke-dashoffset", sign * drawLen);
    }
  },

  mounted() {
    this.getDocumentHeightPercentage();
    window.addEventListener("scroll", this.handleScroll);

    this.svg8a = document.querySelector("#svg_8a");
    this.svg8b = document.querySelector("#svg_8b");
    this.svg9a = document.querySelector("#svg_9a");
    this.svg9b = document.querySelector("#svg_9b");
    this.svg9c = document.querySelector("#svg_9c");
    this.svg9d = document.querySelector("#svg_9d");
    this.svg9e = document.querySelector("#svg_9e");
    this.svg9f = document.querySelector("#svg_9f");
    this.svg9g = document.querySelector("#svg_9g");
    this.svg9h = document.querySelector("#svg_9h");
    this.svg9i = document.querySelector("#svg_9i");
    this.svg9j = document.querySelector("#svg_9j");
    this.svg9k = document.querySelector("#svg_9k");
    this.svg9l = document.querySelector("#svg_9l");
    this.svg9m = document.querySelector("#svg_9m");

    this.setDashArrayAndOffset([
      this.svg8a,
      this.svg8b,
      this.svg9a,
      this.svg9b,
      this.svg9c,
      this.svg9d,
      this.svg9e,
      this.svg9f,
      this.svg9g,
      this.svg9h,
      this.svg9i,
      this.svg9j,
      this.svg9k,
      this.svg9l,
      this.svg9m
    ]);

    this.getSectionsClientHeight({
      sectionId: "section5",
      sectionClientHeight: document.querySelector("#section5").offsetHeight
    });
  },
  destroyed() {
    window.removeEventListener("scroll", this.handleScroll);
  }
};
</script>

<style lang="scss">
#section5 {
  position: relative;
  height: 138vh;
  width: 100%;
  bottom: 0;
  background-color: #333333;

  .txt4.visible {
    // opacity: 1;
    color: #fff;
  }
  .txt4 {
    width: 100%;
    font-size: 20px;
    line-height: 34px;
    position: absolute;
    opacity: 0;
    transition: all 0.3s ease;
    top: 56%;
    left: 46%;
    width: 42%;

    h3 {
      font-size: 14px;
      line-height: 16px;
      padding-bottom: 8px;
      text-transform: uppercase;
      letter-spacing: 1px;
      font-family: canada-type-gibson, sans-serif;
      font-weight: 700;
    }

    p {
      font-size: 25px;
      line-height: 30px;
      letter-spacing: 1px;
      font-family: grad, serif;
    }
  }
}
</style>